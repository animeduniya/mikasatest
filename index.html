<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manga Chapter Fetcher (Comick API)</title>
    <style>
        body { font-family: Arial, sans-serif; background: #121212; color: #fff; padding: 20px; }
        input, button { padding: 8px; margin: 5px; }
        #results { margin-top: 20px; }
        .manga { padding: 10px; margin: 5px; background: #1f1f1f; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Fetch Manga Chapters - Comick API</h1>
    <input type="text" id="searchInput" placeholder="Enter manga title (e.g. solo leveling)">
    <button onclick="searchManga()">Search</button>

    <div id="results"></div>

    <script>
        async function searchManga() {
            const title = document.getElementById('searchInput').value.trim();
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = "Loading...";

            if (!title) {
                resultsDiv.innerHTML = "Please enter a manga title.";
                return;
            }

            try {
                const proxyUrl = "https://thingproxy.freeboard.io/fetch/";
                const apiUrl = `https://api.comick.fun/v1.0/search?q=${encodeURIComponent(title)}`;
                const fullUrl = proxyUrl + apiUrl;

                const response = await fetch(fullUrl);
                if (!response.ok) {
                    throw new Error("Failed to fetch");
                }
                const data = await response.json();

                if (!data || !data.length) {
                    resultsDiv.innerHTML = "No manga found!";
                    return;
                }

                resultsDiv.innerHTML = "";
                data.forEach(manga => {
                    const mangaDiv = document.createElement('div');
                    mangaDiv.className = "manga";

                    mangaDiv.innerHTML = `
                        <h3>${manga.title || manga.slug}</h3>
                        <p><b>Slug:</b> ${manga.slug}</p>
                        <button onclick="fetchChapters('${manga.slug}')">Get Chapters</button>
                        <div id="chapters-${manga.slug}"></div>
                    `;

                    resultsDiv.appendChild(mangaDiv);
                });
            } catch (err) {
                console.error(err);
                resultsDiv.innerHTML = "Error fetching manga.";
            }
        }

        async function fetchChapters(slug) {
            const chaptersDiv = document.getElementById(`chapters-${slug}`);
            chaptersDiv.innerHTML = "Loading chapters...";

            try {
                const proxyUrl = "https://thingproxy.freeboard.io/fetch/";
                const apiUrl = `https://api.comick.fun/v1.0/chapter?slug=${encodeURIComponent(slug)}`;
                const fullUrl = proxyUrl + apiUrl;

                const response = await fetch(fullUrl);
                if (!response.ok) {
                    throw new Error("Failed to fetch chapters");
                }
                const data = await response.json();

                if (!data || !data.chapters || !data.chapters.length) {
                    chaptersDiv.innerHTML = "No chapters found!";
                    return;
                }

                chaptersDiv.innerHTML = "<ul>" +
                    data.chapters.map(ch => `<li>Chapter ${ch.chapter} - ${ch.title || ''}</li>`).join('') +
                    "</ul>";
            } catch (err) {
                console.error(err);
                chaptersDiv.innerHTML = "Error fetching chapters.";
            }
        }
    </script>
</body>
</html>
